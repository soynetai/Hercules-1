<item>
<title>[COLOR orange][+]Buscar[/COLOR]</title>
<link>$doregex[makelist]</link>
<thumbnail>https://raw.githubusercontent.com/Andorth/Hercules/master/imagenes/Buscar.png</thumbnail>
<regex>
<name>makelist</name>
<listrepeat><![CDATA[
<title>[makelist.param2]</title>
<link>$doregex[resolve]</link>
<thumbnail>https://i.ytimg.com/vi/[makelist.param1]/hqdefault.jpg</thumbnail>
]]></listrepeat>
<expres>u'(.+?)', u'(.+?)'</expres>
<page>$doregex[search]</page>
</regex>
 
<regex>
<name>resolve</name>
<expres><![CDATA[#$pyFunction
import urlresolver
def GetLSProData(page_data,Cookie_Jar,m):
 url = 'https://www.youtube.com/watch?v=[makelist.param1]'
 streamLink = urlresolver.resolve(url)
 return streamLink
]]></expres>
<page></page>
</regex>
 
<regex>
<name>search</name>
<expres><![CDATA[#$pyFunction
import requests,xbmcgui,xbmc, re,time, xbmcaddon
def GetLSProData(page_data,Cookie_Jar,m):
 
 text=takeInputFortext('Enter search string')
 url = 'https://www.youtube.com/results?search_query=' + text.replace(' ', '+')
 req = requests.get(url)
 list1 = re.findall('yt-lockup-c.+?a\shref=".watch.v=([^"]+)".+?\s\stitle="([^"]+)"\s', req.text)
 
 count = 50
 while count > 1:
   try:
     url = 'https://www.youtube.com' + re.findall('a href="([^"]+)".+<\/a>\n <\/div>', req.text)[0]
   except:
     return list1
   req = requests.get(url)
   list2 = re.findall('yt-lockup-c.+?a\shref=".watch.v=([^"]+)".+?\s\stitle="([^"]+)"\s', req.text)
   list1 = list1 + list2
   count = count - 1
 return list1
 
def takeInputFortext(txt):
 addon = xbmcaddon.Addon('plugin.video.Hercules')
 addon_version = addon.getAddonInfo('version')
 profile = xbmc.translatePath(addon.getAddonInfo('profile').decode('utf-8'))
 
 solver = InputWindow( txt=txt)
 solution = solver.get()
 return solution
 
class InputWindow(xbmcgui.WindowDialog):
    def __init__(self, *args, **kwargs):
       
        self.txt = kwargs.get('txt','')
 
        xbmcgui.WindowXMLDialog.__init__(self)
        #self.addControl(self.txt)
        path = xbmcaddon.Addon().getAddonInfo('path')
        self.kbd = xbmc.Keyboard()
        self.kbd.setHeading( self.txt)
 
    def get(self):
        self.show()
        time.sleep(2)
        self.kbd.doModal()
        if (self.kbd.isConfirmed()):
            text = self.kbd.getText()
            self.close()
            return text
        self.close()
        return False
]]></expres>
<page></page>
</regex>
</item>

<item>
<title>[COLOR orange][B]DOCUMENTALIA TV[/B][/COLOR] [COLOR white] Categorias [/COLOR]</title>
<link>$doregex[makelist2]</link>

<regex>
<name>makelist2</name>
<listrepeat><![CDATA[
<title>Página [makelist2.param1]</title>
<link>$doregex[makelist3]</link>
<referer></referer>
<thumbnail></thumbnail>
]]></listrepeat>
<expres> (.*?),</expres>
<page>$doregex[get-number]</page>
<cookieJar></cookieJar>
</regex>

<regex>
            <name>makelist3</name>
            <listrepeat><![CDATA[
                        <title>[makelist3.param2]</title>
                        <link>plugin://plugin.video.youtube/play/?video_id=[makelist3.param1]</link>
                        <thumbnail>https://i.ytimg.com/vi/[makelist3.param1]/hqdefault.jpg</thumbnail>
            ]]></listrepeat>
            <expres>spf-link " dir="ltr" href="\/watch\?v=(.*?)&amp;.*?\n(.*)</expres>
            <page>$doregex[get-source-page]</page>
             <cookieJar></cookieJar>
</regex>

<regex>
<name>get-number</name>
<expres><![CDATA[#$pyFunction
def GetLSProData(page_data,Cookie_Jar,m):            

 import requests
 import re
 url='https://www.youtube.com/channel/UCiwazSMPs2OQuljxifCvSiA/'
 headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0', 'Accept-Language': 'en-US'}

 rr = requests.get(url, headers=headers)
 number = re.findall('</a></li><li>(.*?) vid', rr.text)[0]
 #number = number.encode('unicode-escape')
 number = number.replace(',', '')
 real = int(float(number)) / 100
 real2 = real + 3

 liste = list(range(real2))
 return liste
]]></expres>
<page></page>
</regex>

<regex>
<name>get-source-page</name>
<expres><![CDATA[#$pyFunction
def GetLSProData(page_data,Cookie_Jar,m):

 import requests
 import re
 import json

 pageUrl='https://www.youtube.com/channel/UCiwazSMPs2OQuljxifCvSiA/'
 headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0'}
 r1 = requests.get(pageUrl, headers = headers)
 source = r1.text
 page = [makelist2.param1]
 N = int(float(page))
 pre = 'https://www.youtube.com'
 if (N > 1):

   for itr in range (1,N):
    continuex = re.findall('data-uix-load-more-href="(.*?)"', source)[0]
    continuationx = pre + continuex
    r = requests.get(continuationx, headers = headers)
    source = r.text
    jdata = json.loads(source)
    source = jdata["load_more_widget_html"]
    page = jdata["content_html"]
   return page
    
 else:

  return source
]]></expres>
<page></page>
</regex>
<thumbnail>http://2.bp.blogspot.com/-Byzrt0KhvYY/VmhwLtPjRYI/AAAAAAAABOg/jYV8oXmOT28/s400/posadas%2B001.jpg</thumbnail>
<fanart>https://www.euroresidentes.com/navidad/img_09/navidades_01.jpg</fanart>
</item>


<! --
<item>
<title>[B][COLOR orange][·][COLOR white] HD[/B][/COLOR][/COLOR]</title>
<link>ignore</link>
<externallink></externallink>
<thumbnail>https://pasateatorrent.com/wp-content/uploads/2017/04/Imparable-993791954-large.jpg</thumbnail>
</item>


<item>
<title>[B][COLOR orange][·]UNIVERSO[COLOR white] HD[/B][/COLOR][/COLOR]</title>
<link>ignore</link>
<externallink></externallink>
<thumbnail>https://pasateatorrent.com/wp-content/uploads/2017/04/Imparable-993791954-large.jpg</thumbnail>
</item>

-->
